{% extends 'layout/base.html' %}
{% load i18n django_markdown %}

{% block content %}
<section id="event-detail" class="container">

  <div class="event-heading">
    <ul class="event-tags">
      <li class="tags-item">{{ event.get_event_type_display }}</li>
      <li class="tags-item">{{ event.get_topic_display }}</li>
    </ul>
    <h1 class="event-title">{{ event.title }}</h1>
    <div class="event-city">{{ event.place.city }}</div>
    <div class="event-info">
      <span class="event-date">{{ event.event_date }}</span>
      <span class="event-place">
        <a class="link" href="#">
          <i class="fa fa-map-marker"></i>
          {{ event.place }}
        </a>
      </span>
    </div>
  </div>

  <div class="event-image">
    <div class="event-img-wrap">
      <img class="image img-responsive"
           src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQ4AAACHAQMAAADdtyVCAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAANQTFRF////p8QbyAAAAAF0Uk5TAEDm2GYAAAAbSURBVBgZ7cExAQAAAMIg+6deCU9gAAAAAPAWEnUAAUFphIwAAAAASUVORK5CYII="
           alt="{{ event.title }}" style="background-image: url({{ event.get_image_url }});">
      <div class="ticket-price-label">{{ event.get_price_display }}</div>
    </div>
  </div>
  <div class="event-description">
    {{ event.description|markdown }}
  </div>
{% if event.event_source_url %}
  <div class="event-source">
    {% trans 'Source' %}:
    <a href="{{ event.event_source_url }}" target="_blank">{{ event.event_source_url }}</a>
  </div>
{% endif %}
{% if event.image_source_url %}
  <div class="event-source">
    {% trans 'Image' %}:
    <a href="{{ event.image_source_url }}" target="_blank">{{ event.image_source_url }}</a>
  </div>
{% endif %}

  <div class="event-map">
    <script src='https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyC3iZqRXqLY7BLd6fwKjYrqKhoh4qRP8m4'></script>
    <div style='overflow:hidden;height:240px;width:auto;'>
      <div id='map_canvas' style='height:240px;'></div>
      <style>
        #map_canvas img {
          width: auto;
          max-width:none !important;
          background:none !important
        }
      </style>
    </div>
    <script type='text/javascript'>
      function init_map(){
        var myOptions = {
          zoom: 15,
          center: new google.maps.LatLng({{ event.get_event_latitude_str }},{{ event.get_event_longitude_str }}),
          mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);
        marker = new google.maps.Marker({
          map: map,position: new google.maps.LatLng({{ event.get_event_latitude_str }},{{ event.get_event_longitude_str }})
        });
        infowindow = new google.maps.InfoWindow({
          content:'<strong>{{ event.place }}</strong><br>{{ event.event_date }}<br>'
        });
        google.maps.event.addListener(marker, 'click', function(){
          infowindow.open(map,marker);
        });
        infowindow.open(map,marker);}
      google.maps.event.addDomListener(window, 'load', init_map);
    </script>
  </div>

</section><!--/#event-detail-->
{% endblock content %}
